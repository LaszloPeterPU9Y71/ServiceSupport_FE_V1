<div class="container mt-4">
  <h2>Tulajdonos személyek</h2>

  @if (error()) {
    <div class="alert alert-danger alert-dismissible fade show d-flex align-items-center justify-content-between mt-3" role="alert">
      <div class="me-2">
        <i class="bi bi-exclamation-triangle-fill me-2"></i>
        {{ error() }}
      </div>
      <button type="button" class="btn-close" aria-label="Bezárás" (click)="error.set(null)"></button>
    </div>
  }
  <!-- Új alkalmazott -->
  <div class="card p-3 mb-4">
    <h5>Új  tulajdonos felvétele</h5>
    <div class="row g-2">
      <div class="col-md-2">
        <input type="text" class="form-control" placeholder="Név" [(ngModel)]="newEmployee().name">
      </div>
      <div class="col-md-2">
        <input type="email" class="form-control" placeholder="Email" [(ngModel)]="newEmployee().email">
      </div>
      <div class="col-md-2">
        <input type="text" class="form-control" placeholder="Telefon" [(ngModel)]="newEmployee().telNum">
      </div>
      <div class="col-md-2">
        <input type="text" class="form-control" placeholder="Beosztás" [(ngModel)]="newEmployee().title">
      </div>
      <div class="col-md-2">
        <input type="text" class="form-control" placeholder="Cégnév" [(ngModel)]="newEmployee().ownerCompanyName">
      </div>
      <div class="col-md-2">
        <button class="btn btn-success w-100" (click)="addEmployee()">Hozzáadás</button>
      </div>
    </div>
  </div>

  <!-- Lista -->
  <table class="table table-bordered table-striped">
    <thead class="table-dark">
    <tr>
      <th>Név</th>
      <th>Email</th>
      <th>Telefon</th>
      <th>Beosztás</th>
      <th>Cégnév</th>
      <th>Műveletek</th>
    </tr>
    <tr>
      <th>
        <input class="form-control"
               [ngModel]="filters()['name']"
               (ngModelChange)="updateFilter('name', $event)"
               placeholder="Keresés...">
      </th>
      <th>
        <input class="form-control"
               [ngModel]="filters()['email']"
               (ngModelChange)="updateFilter('email', $event)"
               placeholder="Keresés...">
      </th>
      <th>
        <input class="form-control"
               [ngModel]="filters()['telNum']"
               (ngModelChange)="updateFilter('telNum', $event)"
               placeholder="Keresés...">
      </th>
      <th></th>
      <th>
        <input class="form-control"
               [ngModel]="filters()['ownerCompanyName']"
               (ngModelChange)="updateFilter('ownerCompanyName', $event)"
               placeholder="Keresés...">
      </th>
      <th></th>
    </tr>
    </thead>
    <tbody>
      @for (emp of filteredEmployees(); track emp.id) {
        <tr>
          @if (editingEmployee() && editingEmployee()?.id === emp.id) {

            <td><input type="text" class="form-control" [(ngModel)]="editingEmployee()!.name"></td>
            <td><input type="email" class="form-control" [(ngModel)]="editingEmployee()!.email"></td>
            <td><input type="number" class="form-control" [(ngModel)]="editingEmployee()!.telNum"></td>
            <td><input type="text" class="form-control" [(ngModel)]="editingEmployee()!.title"></td>
            <td><input type="text" class="form-control" [(ngModel)]="editingEmployee()!.ownerCompanyName"></td>
            <td>
              <button class="btn btn-primary btn-sm me-2" (click)="saveEdit()">Mentés</button>
              <button class="btn btn-secondary btn-sm" (click)="cancelEdit()">Mégse</button>
            </td>
          } @else {

            <td>{{ emp.name }}</td>
            <td>{{ emp.email }}</td>
            <td>{{ emp.telNum }}</td>
            <td>{{ emp.title }}</td>
            <td>{{ emp.ownerCompanyName }}</td>
            <td>
              <button class="btn btn-warning btn-sm me-2" (click)="editEmployee(emp)">Szerkesztés</button>
              <button class="btn btn-danger btn-sm" (click)="deleteEmployee(emp.id!)">Törlés</button>
            </td>
          }
        </tr>
      }
    </tbody>
  </table>
</div>
